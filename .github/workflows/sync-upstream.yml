name: Sync Upstream

on:
  schedule:
    - cron: '0 0 * * *'  # Executa diariamente à meia-noite
  workflow_dispatch:       # Permite execução manual

jobs:
  sync:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout código
      uses: actions/checkout@v3
      with:
        token: ${{ secrets.GITHUB_TOKEN }}
        fetch-depth: 0

    - name: Configurar Git
      run: |
        git config user.name "GitHub Actions"
        git config user.email "actions@github.com"

    - name: Adicionar upstream remote
      run: |
        git remote add upstream https://github.com/FR33THYFRI3THY/ULtimate-Windows-Optimization-Guide || true

    - name: Fetch upstream
      run: git fetch upstream

    - name: Merge upstream
      run: |
        git checkout main
        git merge upstream/main --strategy-option theirs || {
          git merge --abort
          git reset --hard upstream/main
          git push origin main --force
        }
